@using Universidad.Entidades
@{
    ViewBag.Title = "MAT_CAT_CREDITOS_POR_MATERIA";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var listaCatalogo = new List<MAT_CAT_CREDITOS_POR_HORAS>();

    if (ViewBag.ListaCatalogo != null)
    {
        listaCatalogo = ViewBag.ListaCatalogo;
    }
}
@section Head
{
    <script src="~/Scripts/bootstrap.js" type="text/javascript"></script>
    <link href="~/Content/bootstrap.css" type="text/css" rel="stylesheet" />
    <script src="~/Scripts/bootstrap-datepicker.js" type="text/javascript"></script>
    <link href="~/Content/bootstrap-datepicker.css" type="text/css" rel="stylesheet" />
    <script src="~/Scripts/bootstrap-select.js" type="text/javascript"></script>
    <link href="~/Content/bootstrap-select.css" type="text/css" rel="stylesheet" />
    <script src="~/Scripts/bootstrap-multiselect.js" type="text/javascript"></script>
    <link href="~/Content/bootstrap-multiselect.css" type="text/css" rel="stylesheet" />
}

@section Scripts
{
    <script type="text/javascript">


        function ValidaCreditos(nombreTextbox) {

            var control = $("#"+nombreTextbox+"");
            var texto = control.val();
            var regexExp = /[0-9]{1,3}\.[0-9]{1,2}/;
            var valido = regexExp.test(texto);

            if (valido == false) {
                alert('El valor es incorrecto, debe seguir un formato 000.00');
                control.val('000.00');
            }
        }

        $(document).ready(function () {
            $("#txtCreditosMinimosActualizar").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtCreditosMinimosNuevo").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtCreditosMaximosActualizar").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtCreditosMaximosNuevo").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMinimasPorSemanaActualizar").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMinimasPorSemanaNuevo").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMaximasPorSemanaActualizar").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMaximasPorSemanaNuevo").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMaximasPorSemestreActualizar").focusout(function () {
                ValidaCreditos(this.name);
            });

            $("#txtHorasMaximasPorSemestreNuevo").focusout(function () {
                ValidaCreditos(this.name);
            });
        });

        function show_modal(modalName, idCredito, creditosMinimos, creditosMaximos, horasMinimasSemana, horasMaximasSemana, horasTotalesporSemestre) {

            $("#txtIdCreditosVer").val(idCredito);
            $("#txtCreditosMinimosVer").val(creditosMinimos);
            $("#txtCreditosMaximosVer").val(creditosMaximos);
            $("#txtHorasMinimasPorSemanaVer").val(horasMinimasSemana);
            $("#txtHorasMaximasPorSemanaVer").val(horasMaximasSemana);
            $("#txtHorasMaximasPorSemestreVer").val(horasTotalesporSemestre);

            $("#txtIdCreditosActualizar").val(idCredito);
            $("#txtCreditosMinimosActualizar").val(creditosMinimos);
            $("#txtCreditosMaximosActualizar").val(creditosMaximos);
            $("#txtHorasMinimasPorSemanaActualizar").val(horasMinimasSemana);
            $("#txtHorasMaximasPorSemanaActualizar").val(horasMaximasSemana);
            $("#txtHorasTotalesPorSemestreActualizar").val(horasTotalesporSemestre);

            $('#' + modalName + '').modal('show');
        }

        function Nuevo() {
            $("#txtIdCreditosNuevo").val("");
            $("#txtCreditosMinimosNuevo").val("");
            $("#txtCreditosMaximosNuevo").val("");
            $("#txtHorasMinimasPorSemanaNuevo").val("");
            $("#txtHorasMaximasPorSemanaNuevo").val("");
            $("#txtHorasMaximasPorSemestreNuevo").val("");

            $('#modalNuevoRegistro').modal('show');
        }

        function NuevoRegistro() {

            var idCreditos = $("#txtIdCreditosNuevo").val();
            var creditosMinimos = $("#txtCreditosMinimosNuevo").val();
            var creditosMaximos = $("#txtCreditosMaximosNuevo").val();
            var horasMinimasSemana = $("#txtHorasMinimasPorSemanaNuevo").val();
            var horasMaximasSemana = $("#txtHorasMaximasPorSemanaNuevo").val();
            var horasTotalesporSemestre = $("#txtHorasTotalesPorSemestreNuevo").val();

            $.ajax({
                type: "POST",
                data: {
                    'idCreditos': idCreditos,
                    'creditosMinimos': creditosMinimos,
                    'creditosMaximos': creditosMaximos,
                    'horasMinimasSemana': horasMinimasSemana,
                    'horasMaximasSemana': horasMaximasSemana,
                    'horasTotalesporSemestre': horasTotalesporSemestre,
                },
                url: '@Url.Action("NuevoRegistroMatCatCreditosPorHoras", "Catalogos")',
                success: function (response) {

                    $('#modalNuevoRegistro').modal('hide');

                    if (response) {
                        if (response == true)
                            alert("true");
                        location.reload();
                    } else {
                        alert("No se guardo el registro");
                    }
                },
                error:
                    function () {
                        alert("Error en el envio de la informacion");
                    }
            });
        }

        function Actualiza() {
            debugger;
            var idCreditos = $("#txtIdCreditosActualizar").val();
            var creditosMinimos = $("#txtCreditosMinimosActualizar").val();
            var creditosMaximos = $("#txtCreditosMaximosActualizar").val();
            var horasMinimasSemana = $("#txtHorasMinimasPorSemanaActualizar").val();
            var horasMaximasSemana = $("#txtHorasMaximasPorSemanaActualizar").val();
            var horasTotalesporSemestre = $("#txtHorasTotalesPorSemestreActualizar").val();

            $.ajax({
                type: "POST",
                data: {
                    'idCreditos': idCreditos,
                    'creditosMinimos': creditosMinimos,
                    'creditosMaximos': creditosMaximos,
                    'horasMinimasSemana': horasMinimasSemana,
                    'horasMaximasSemana': horasMaximasSemana,
                    'horasTotalesporSemestre': horasTotalesporSemestre,
                },
                url: '@Url.Action("ActualizaMatCatCreditosPorHoras", "Catalogos")',
                success: function (response) {

                    $('#modalActualizaRegistro').modal('hide');

                    if (response) {
                        if (response == true)
                            alert("true");
                        location.reload();
                    } else {
                        alert("false");
                    }
                },
                error:
                    function (xhr, status, error) {
                        alert(status + " : " + error);
                    }
            });
        }

        function Ver(modalName, idCredito, creditosMinimos, creditosMaximos, horasMinimasSemana, horasMaximasSemana, horasTotalesporSemestre) {

            $("#txtIdCreditosVer").val(idCredito);
            $("#txtCreditosMinimosVer").val(creditosMinimos);
            $("#txtCreditosMaximosVer").val(creditosMaximos);
            $("#txtHorasMinimasPorSemanaVer").val(horasMinimasSemana);
            $("#txtHorasMaximasPorSemanaVer").val(horasMaximasSemana);
            $("#txtHorasMaximasPorSemestreVer").val(horasTotalesporSemestre);

            $('#modalVerRegistro').modal('show');
        }

    </script>
}

<br />

<h4>Catalogo @ViewBag.Title</h4>

<h5>En este catalogo se describen los distintos tipos de horarios con los cuales se cuenta</h5>

<br />

<div class="col-md-12">
    <table class="table">
        <tr>
            <th>
                IdMateria
            </th>
            <th>
                Creditos Minimos
            </th>
            <th>
                Creditos Maximos
            </th>
            <th>
                Horas Minimas por semana
            </th>
            <th>
                Horas maximas por semana
            </th>
            <th>
                Horas totales por semestre
            </th>
            <th>
                Operaciones
            </th>
        </tr>

        @foreach (var item in listaCatalogo)
        {
            <tr>
                <td>
                    @item.IDCREDITOS
                </td>
                <td>
                    @item.CREDITOSMINIMOS
                </td>
                <td>
                    @item.CREDITOSMAXIMOS
                </td>
                <td>
                    @item.HORASMINIMASPORSEMANA
                </td>
                <td>
                    @item.HORASMAXIMASPORSEMANA
                </td>
                <td>
                    @item.HORASTOTALESPORSEMESTRE
                </td>
                <td style="align-content: center;">
                    <a id="btnEliminar" href="@Url.Action("EliminaMatCatCreditosPorHoras", "Catalogos", new { idCreditos = item.IDCREDITOS, creditosMinimos = item.CREDITOSMINIMOS, creditosMaximos = item.CREDITOSMAXIMOS, horasMinimasSemana = item.HORASMINIMASPORSEMANA, horasMaximasSemana =  item.HORASMAXIMASPORSEMANA, horasTotalesporSemestre=item.HORASTOTALESPORSEMESTRE})" class="btn btn-default btn-sm">Elimina</a>
                    <button name="btnEditar" class="btn btn-default btn-sm" onclick="show_modal('modalActualizaRegistro','@item.IDCREDITOS','@item.CREDITOSMINIMOS', '@item.CREDITOSMAXIMOS', '@item.HORASMINIMASPORSEMANA', '@item.HORASMAXIMASPORSEMANA', '@item.HORASTOTALESPORSEMESTRE')">Editar</button>
                    <button name="btnVer" class="btn btn-default btn-sm" onclick="show_modal('modalVerRegistro','@item.IDCREDITOS','@item.CREDITOSMINIMOS', '@item.CREDITOSMAXIMOS', '@item.HORASMINIMASPORSEMANA', '@item.HORASMAXIMASPORSEMANA', '@item.HORASTOTALESPORSEMESTRE')">ver</button>
                </td>
            </tr>
        }
    </table>
    <br />

    <div style="margin-top: 10px; float: right;" class="form-group">
        <button type="button" class="btn btn-default" onclick="Nuevo();">Nuevo</button>
    </div>
</div>

<div class="modal fade" id="modalActualizaRegistro" tabindex="-1" role="dialog" aria-labelledby="modalLabelProducto" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="modalLabelProducto">
                    <label id="lblUsuario" text="label">Actualizar registro</label>
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="row" style="margin: 0 0 0 0; padding: 0 0 0 0;">
                        <div class="form-group col-md-12">
                            <div class="form-group col-md-12">
                                @Html.Label("IdCreditos", null, new { @class = "" })
                                @Html.TextBox("txtIdCreditosActualizar", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                                @Html.Label("Creditos minimos", null, new { @class = "" })
                                @Html.TextBox("txtCreditosMinimosActualizar", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                                @Html.Label("Creditos maximos", null, new { @class = "" })
                                @Html.TextBox("txtCreditosMaximosActualizar", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                                @Html.Label("Horas minimas por semana", null, new { @class = "" })
                                @Html.TextBox("txtHorasMinimasPorSemanaActualizar", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                                @Html.Label("Horas maximas por semana", null, new { @class = "" })
                                @Html.TextBox("txtHorasMaximasPorSemanaActualizar", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                                @Html.Label("Horas totales por semestre", null, new { @class = "" })
                                @Html.TextBox("txtHorasTotalesPorSemestreActualizar", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="Actualiza();">Actualizar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="modalNuevoRegistro" tabindex="-1" role="dialog" aria-labelledby="modalNuevoRegistro" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="modalLabelProducto">
                    <label id="lblUsuario" text="label">Nuevo registro</label>
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="row" style="margin: 0 0 0 0; padding: 0 0 0 0;">
                        <div class="form-group col-md-12">
                            @Html.Label("IdCreditos", null, new { @class = "" })
                            @Html.TextBox("txtIdCreditosNuevo", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Creditos minimos", null, new { @class = "" })
                            @Html.TextBox("txtCreditosMinimosNuevo", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                            @Html.Label("Creditos maximos", null, new { @class = "" })
                            @Html.TextBox("txtCreditosMaximosNuevo", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                            @Html.Label("Horas minimas por semana", null, new { @class = "" })
                            @Html.TextBox("txtHorasMinimasPorSemanaNuevo", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Horas maximas por semana", null, new { @class = "" })
                            @Html.TextBox("txtHorasMaximasPorSemanaNuevo", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Horas totales por semestre", null, new { @class = "" })
                            @Html.TextBox("txtHorasTotalesPorSemestreNuevo", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="NuevoRegistro();">Agregar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalVerRegistro" tabindex="-1" role="dialog" aria-labelledby="modalNuevoRegistro" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="modalLabelProducto">
                    <label id="lblUsuario" text="label">Registro</label>
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="row" style="margin: 0 0 0 0; padding: 0 0 0 0;">
                        <div class="form-group col-md-12">
                            @Html.Label("IdCreditos", null, new { @class = "" })
                            @Html.TextBox("txtIdCreditosVer", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Creditos minimos", null, new { @class = "" })
                            @Html.TextBox("txtCreditosMinimosVer", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                            @Html.Label("Creditos maximos", null, new { @class = "" })
                            @Html.TextBox("txtCreditosMaximosVer", "", new { @class = "form-control", placeholder = "Nombre de turno", autocomplete = "off" })
                            @Html.Label("Horas minimas por semana", null, new { @class = "" })
                            @Html.TextBox("txtHorasMinimasPorSemanaVer", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Horas maximas por semana", null, new { @class = "" })
                            @Html.TextBox("txtHorasMaximasPorSemanaVer", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                            @Html.Label("Horas totales por semestre", null, new { @class = "" })
                            @Html.TextBox("txtHorasTotalesPorSemestreVer", "", new { @class = "form-control", placeholder = "IdTurno", autocomplete = "off" })
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 9.0.908
--   Created On : jueves, 31 marzo, 2016 
--   DBMS       : SQL Server 2008 
--   -------------------------------------------------- 


--  Drop Foreign Key Constraints 
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_UsUsuarios_UsTipoUsuario') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE UsUsuarios DROP CONSTRAINT FK_UsUsuarios_UsTipoUsuario
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_UsUsuarioPorZona_UsUsuarios') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE UsUsuarioPorZona DROP CONSTRAINT FK_UsUsuarioPorZona_UsUsuarios
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_UsUsuarioPorZona_UsZona') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE UsUsuarioPorZona DROP CONSTRAINT FK_UsUsuarioPorZona_UsZona
;


--  Drop Tables, Stored Procedures and Views 

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsUsuarios') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsUsuarios
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsTipoUsuario') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsTipoUsuario
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsEstatusUsuario') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsEstatusUsuario
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsZona') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsZona
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsPermisos') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsPermisos
;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('UsUsuarioPorZona') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE UsUsuarioPorZona
;


--  Create Tables 
CREATE TABLE UsUsuarios ( 
	IdUsuario int identity(1,1)  NOT NULL,
	Usuario varchar(50) NOT NULL,
	Contrasena varchar(50) NOT NULL,
	IdTipoUsuario int,
	IdEstatusUsuario int,
	Borrado bit NOT NULL
)
;

CREATE TABLE UsTipoUsuario ( 
	IdTipoUsuario int NOT NULL,
	TipoUsuario varchar(max),
	Descripcion varchar(max),
	Borrado bit NOT NULL
)
;

CREATE TABLE UsEstatusUsuario ( 
	IdEstatusUsuario int NOT NULL,
	EstatusUsuario varchar(max),
	Descripcion varchar(max) NOT NULL,
	Borrado bit NOT NULL
)
;

CREATE TABLE UsZona ( 
	IdZona int NOT NULL,
	NombreZona varchar(max),
	Descripcion varchar(max),
	Borrado bit
)
;

CREATE TABLE UsPermisos ( 
	IdPermisos int NOT NULL,
	Descripcion varbinary(max),
	Borrado bit
)
;

CREATE TABLE UsUsuarioPorZona ( 
	IdUsuarioZona int identity(1,1)  NOT NULL,
	IdZona int,
	IdUsuarios int
)
;


--  Create Indexes 
ALTER TABLE UsUsuarios
	ADD CONSTRAINT UQ_UsUsuarios_Usuario UNIQUE (Usuario)
;

--  Create Primary Key Constraints 
ALTER TABLE UsUsuarios ADD CONSTRAINT PK_UsUsuarios 
	PRIMARY KEY CLUSTERED (IdUsuario)
;

ALTER TABLE UsTipoUsuario ADD CONSTRAINT PK_UsTipoUsuario 
	PRIMARY KEY CLUSTERED (IdTipoUsuario)
;

ALTER TABLE UsEstatusUsuario ADD CONSTRAINT PK_UsEstatusUsuario 
	PRIMARY KEY CLUSTERED (IdEstatusUsuario)
;

ALTER TABLE UsZona ADD CONSTRAINT PK_UsZona 
	PRIMARY KEY CLUSTERED (IdZona)
;

ALTER TABLE UsPermisos ADD CONSTRAINT PK_UsPermisos 
	PRIMARY KEY CLUSTERED (IdPermisos)
;

ALTER TABLE UsUsuarioPorZona ADD CONSTRAINT PK_UsUsuarioPorZona 
	PRIMARY KEY CLUSTERED (IdUsuarioZona)
;



--  Create Foreign Key Constraints 
ALTER TABLE UsUsuarios ADD CONSTRAINT FK_UsUsuarios_UsTipoUsuario 
	FOREIGN KEY (IdTipoUsuario) REFERENCES UsTipoUsuario (IdTipoUsuario)
;

ALTER TABLE UsUsuarioPorZona ADD CONSTRAINT FK_UsUsuarioPorZona_UsUsuarios 
	FOREIGN KEY (IdUsuarios) REFERENCES UsUsuarios (IdUsuario)
;

ALTER TABLE UsUsuarioPorZona ADD CONSTRAINT FK_UsUsuarioPorZona_UsZona 
	FOREIGN KEY (IdZona) REFERENCES UsZona (IdZona)
;

INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'PERSONA_LINK_ID' AS CAMPO_NOMBRE, PERSONA_LINK_ID AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'PERSONA_LINK_ID');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'NOMBRE_COMPLETO' AS CAMPO_NOMBRE, NOMBRE_COMPLETO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'NOMBRE_COMPLETO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'NOMBRE' AS CAMPO_NOMBRE, NOMBRE AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'NOMBRE');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'APATERNO' AS CAMPO_NOMBRE, APATERNO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'APATERNO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'AMATERNO' AS CAMPO_NOMBRE, AMATERNO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'AMATERNO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'FECHA_NAC' AS CAMPO_NOMBRE, FECHA_NAC AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'FECHA_NAC');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'RFC' AS CAMPO_NOMBRE, RFC AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'RFC');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CURP' AS CAMPO_NOMBRE, CURP AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CURP');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'IMSS' AS CAMPO_NOMBRE, IMSS AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'IMSS');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'ESTUDIOS' AS CAMPO_NOMBRE, ESTUDIOS AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'ESTUDIOS');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'SEXO' AS CAMPO_NOMBRE, SEXO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'SEXO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'NACIONALIDAD' AS CAMPO_NOMBRE, NACIONALIDAD AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'NACIONALIDAD');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'FECHA_INGRESO' AS CAMPO_NOMBRE, FECHA_INGRESO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'FECHA_INGRESO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'FECHA_BAJA' AS CAMPO_NOMBRE, FECHA_BAJA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'FECHA_BAJA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_CALLE_NO' AS CAMPO_NOMBRE, DP_CALLE_NO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_CALLE_NO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_COLONIA' AS CAMPO_NOMBRE, DP_COLONIA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_COLONIA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_DELEGACION' AS CAMPO_NOMBRE, DP_DELEGACION AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_DELEGACION');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_CIUDAD' AS CAMPO_NOMBRE, DP_CIUDAD AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_CIUDAD');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_ESTADO' AS CAMPO_NOMBRE, DP_ESTADO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_ESTADO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_PAIS' AS CAMPO_NOMBRE, DP_PAIS AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_PAIS');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_CP' AS CAMPO_NOMBRE, DP_CP AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_CP');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_TELEFONO1' AS CAMPO_NOMBRE, DP_TELEFONO1 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_TELEFONO1');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_TELEFONO2' AS CAMPO_NOMBRE, DP_TELEFONO2 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_TELEFONO2');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_CELULAR1' AS CAMPO_NOMBRE, DP_CELULAR1 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_CELULAR1');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DP_CELULAR2' AS CAMPO_NOMBRE, DP_CELULAR2 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DP_CELULAR2');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_CALLE_NO' AS CAMPO_NOMBRE, DT_CALLE_NO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_CALLE_NO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_COLONIA' AS CAMPO_NOMBRE, DT_COLONIA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_COLONIA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_DELEGACION' AS CAMPO_NOMBRE, DT_DELEGACION AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_DELEGACION');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_CIUDAD' AS CAMPO_NOMBRE, DT_CIUDAD AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_CIUDAD');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_ESTADO' AS CAMPO_NOMBRE, DT_ESTADO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_ESTADO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_PAIS' AS CAMPO_NOMBRE, DT_PAIS AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_PAIS');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_CP' AS CAMPO_NOMBRE, DT_CP AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_CP');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_TELEFONO1' AS CAMPO_NOMBRE, DT_TELEFONO1 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_TELEFONO1');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_TELEFONO2' AS CAMPO_NOMBRE, DT_TELEFONO2 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_TELEFONO2');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_CELULAR1' AS CAMPO_NOMBRE, DT_CELULAR1 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_CELULAR1');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DT_CELULAR2' AS CAMPO_NOMBRE, DT_CELULAR2 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DT_CELULAR2');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CENTRO_DE_COSTOS' AS CAMPO_NOMBRE, CENTRO_DE_COSTOS AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CENTRO_DE_COSTOS');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'AREA' AS CAMPO_NOMBRE, AREA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'AREA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DEPARTAMENTO' AS CAMPO_NOMBRE, DEPARTAMENTO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DEPARTAMENTO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'PUESTO' AS CAMPO_NOMBRE, PUESTO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'PUESTO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'GRUPO' AS CAMPO_NOMBRE, GRUPO AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'GRUPO');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'NO_CREDENCIAL' AS CAMPO_NOMBRE, NO_CREDENCIAL AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'NO_CREDENCIAL');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'LINEA_PRODUCCION' AS CAMPO_NOMBRE, LINEA_PRODUCCION AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'LINEA_PRODUCCION');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CLAVE_EMPL' AS CAMPO_NOMBRE, CLAVE_EMPL AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CLAVE_EMPL');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'COMPANIA' AS CAMPO_NOMBRE, COMPANIA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'COMPANIA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'DIVISION' AS CAMPO_NOMBRE, DIVISION AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'DIVISION');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'REGION' AS CAMPO_NOMBRE, REGION AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'REGION');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'TIPO_NOMINA' AS CAMPO_NOMBRE, TIPO_NOMINA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'TIPO_NOMINA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'ZONA' AS CAMPO_NOMBRE, ZONA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'ZONA');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CAMPO1' AS CAMPO_NOMBRE, CAMPO1 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CAMPO1');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CAMPO2' AS CAMPO_NOMBRE, CAMPO2 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CAMPO2');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CAMPO3' AS CAMPO_NOMBRE, CAMPO3 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CAMPO3');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CAMPO4' AS CAMPO_NOMBRE, CAMPO4 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CAMPO4');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'CAMPO5' AS CAMPO_NOMBRE, CAMPO5 AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'CAMPO5');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'REGLA_VACA_ID' AS CAMPO_NOMBRE, REGLA_VACA_ID AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'REGLA_VACA_ID');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'SUELDO_DIA' AS CAMPO_NOMBRE, SUELDO_DIA AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS_DATOS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'SUELDO_DIA');

INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'PERSONA_NOMBRE' AS CAMPO_NOMBRE, PERSONA_NOMBRE AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'PERSONA_NOMBRE');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'AGRUPACION_NOMBRE' AS CAMPO_NOMBRE, AGRUPACION_NOMBRE AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'AGRUPACION_NOMBRE');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'PERSONA_EMAIL' AS CAMPO_NOMBRE, PERSONA_EMAIL AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'PERSONA_EMAIL');
INSERT INTO EC_PERSONAS_DATO (PERSONA_DATO_ID, SESION_ID, PERSONA_ID, CAMPO_NOMBRE, PERSONA_DATO, PERSONA_DATO_FECHA) SELECT (SELECT MAX(PERSONA_DATO_ID) FROM EC_PERSONAS_DATO)+ROW_NUMBER() OVER (ORDER BY PERSONA_ID)   AS PERSONA_DATO_ID, 0 AS SESION_ID, PERSONA_ID, 'TURNO_ID' AS CAMPO_NOMBRE, TURNO_ID AS PERSONA_DATO, GETDATE() AS PERSONA_DIARIO_FECHA FROM EC_PERSONAS WHERE PERSONA_ID NOT IN (SELECT PERSONA_ID FROM EC_PERSONAS_DATO WHERE CAMPO_NOMBRE = 'TURNO_ID');

